3
((),
  Value
    (@., non_rec, tail, [ A ], [ (l, Type (list/1, A)) ],
      Some Monad ([ OCaml.Failure/1 ], Type (list/1, A))) =
    Match
      (4, Variable (4, l/0),
        [
          (Constructor (cons/1, Any, xs), Return (?, Variable (5, xs/0)));
          (Constructor ([]/1),
            Apply
              (6, Variable (6, OCaml.Pervasives.failwith/1),
                [
                  Constant
                    (6,
                      String("Cannot take the tail of an empty list."))
                ]))
        ]))

8
((),
  Value
    (@., rec, print_list_rec, [ ],
      [ (counter, Type (nat/1)); (x, Type (list/1, Type (string/1))) ],
      Some Monad ([ IO/0; NonTermination/1 ], Type (unit/1))) =
    Match
      (?, Variable (?, counter/0),
        [
          (Constructor (O/1),
            Lift
              (?, [ NonTermination/1 ], [ IO/0; NonTermination/1 ],
                Apply
                  (?, Variable (?, not_terminated/1),
                    [ Tuple (?) ])));
          (Constructor (S/1, counter),
            Match
              (?, Variable (?, x/0),
                [
                  (Constructor ([]/1),
                    Return
                      (?,
                        Constructor
                          (9,
                            tt/1)));
                  (Constructor (cons/1, x, xs),
                    Bind
                      (?,
                        Lift
                          (?,
                            [
                              IO/0
                            ],
                            [
                              IO/0;
                              NonTermination/1
                            ],
                            Apply
                              (11,
                                Variable
                                  (11,
                                    OCaml.Pervasives.print_string/0),
                                [
                                  Variable
                                    (11,
                                      x/0)
                                ])),
                        None,
                        Apply
                          (12,
                            Apply
                              (?,
                                Variable
                                  (?,
                                    print_list_rec/0),
                                [
                                  Variable
                                    (?,
                                      counter/0)
                                ]),
                            [
                              Variable
                                (12,
                                  xs/0)
                            ])))
                ]))
        ]))

8
((),
  Value
    (@., non_rec, print_list, [ ], [ (x, Type (list/1, Type (string/1))) ],
      Some Monad ([ Counter/1; IO/0; NonTermination/1 ], Type (unit/1))) =
    Bind
      (?,
        Lift
          (?, [ Counter/1 ], [ Counter/1; IO/0; NonTermination/1 ],
            Apply (?, Variable (?, read_counter/1), [ Tuple (?) ])), Some x_1,
        Lift
          (?, [ IO/0; NonTermination/1 ], [ Counter/1; IO/0; NonTermination/1 ],
            Apply
              (?, Variable (?, print_list_rec/0),
                [ Variable (?, x_1/0); Variable (?, x/0) ]))))

14
((),
  Value
    (@., non_rec, f, [ ], [ ],
      Some
        (Type (list/1, Type (string/1)) ->
          Monad ([ Counter/1; IO/0; NonTermination/1 ], Type (unit/1)))) =
    Variable (14, print_list/0))

16
((),
  Value
    (@., non_rec, x, [ A ], [ (z, A) ],
      Some
        Monad
          ([ Counter/1; IO/0; NonTermination/1; OCaml.Failure/1 ], Type (unit/1)))
    =
    Bind
      (?,
        Lift
          (?, [ OCaml.Failure/1 ],
            [ Counter/1; IO/0; NonTermination/1; OCaml.Failure/1 ],
            Apply
              (16, Variable (16, tail/0),
                [
                  Constructor
                    (16, cons/1, Constant (16, String("Stop")),
                      Constructor
                        (16, cons/1,
                          Constant
                            (16,
                              String("Hello")),
                          Constructor
                            (16,
                              cons/1,
                              Constant
                                (16,
                                  String(" ")),
                              Constructor
                                (16,
                                  cons/1,
                                  Constant
                                    (16,
                                      String("world")),
                                  Constructor
                                    (16,
                                      []/1)))))
                ])), Some x,
        Lift
          (?, [ Counter/1; IO/0; NonTermination/1 ],
            [ Counter/1; IO/0; NonTermination/1; OCaml.Failure/1 ],
            Apply (16, Variable (16, f/0), [ Variable (?, x/0) ]))))
